package controllers.generators;

import com.fasterxml.jackson.databind.ObjectMapper;
import model.TimeTableBean;

import java.io.IOException;
import java.util.*;

public class DataGenerator {

    private static Random random = new Random();
    private static int genderMod = 0;
    private static int isWorkingMod = 0;
    private static int hasTicketMod = 0;

    private static Map<String, ArrayList<TimeTableBean>>  publicTransportTimeTable = new HashMap<>();

    private static Map<String, ArrayList<TimeTableBean>>  parsePTTimeTable() {

        Map<String, ArrayList<TimeTableBean>> publicTransportTimeTable = new HashMap<>();

        ObjectMapper objectMapper = new ObjectMapper();

        try {
            List list = objectMapper.readValue("[{\"arrivalTick\":30,\"connectionID\":\"S6\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":30,\"connectionID\":\"RB 47(24607)\",\"vehicle\":\"Train\",\"origin\":\"WÖ-A45\"},{\"arrivalTick\":32,\"connectionID\":\"RE 99(24903)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":35,\"connectionID\":\"RB 16(24504)\",\"vehicle\":\"Train\",\"origin\":\"HG-A5\"},{\"arrivalTick\":37,\"connectionID\":\"RB 49(15074)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":37,\"connectionID\":\"RB 48(24255)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":40,\"connectionID\":\"RB 49/41(15052)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":41,\"connectionID\":\"S6\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":42,\"connectionID\":\"RB 41(15003)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":42,\"connectionID\":\"RB 16(24562)\",\"vehicle\":\"Train\",\"origin\":\"HG-A5\"},{\"arrivalTick\":42,\"connectionID\":\"RB 40(15103)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":44,\"connectionID\":\"RE 30(4152)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":48,\"connectionID\":\"RB 49(15151)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":54,\"connectionID\":\"RB 48(24257)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":58,\"connectionID\":\"RE 30(15863)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":63,\"connectionID\":\"RB 49(15075)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":64,\"connectionID\":\"RB 49(15075)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":65,\"connectionID\":\"RB 16(24506)\",\"vehicle\":\"Train\",\"origin\":\"HG-A5\"},{\"arrivalTick\":66,\"connectionID\":\"RB 47(24663)\",\"vehicle\":\"Train\",\"origin\":\"WÖ-A45\"},{\"arrivalTick\":67,\"connectionID\":\"RB 49(15164)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":71,\"connectionID\":\"RE 30(4153)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":71,\"connectionID\":\"RE 30(4173)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":71,\"connectionID\":\"S6\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":74,\"connectionID\":\"RB 40(15104)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":85,\"connectionID\":\"RB 15049\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":85,\"connectionID\":\"RB 47(24609)\",\"vehicle\":\"Train\",\"origin\":\"WÖ-A45\"},{\"arrivalTick\":89,\"connectionID\":\"RE 30(4179)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":95,\"connectionID\":\"RB 16(24508)\",\"vehicle\":\"Train\",\"origin\":\"HG-A5\"},{\"arrivalTick\":97,\"connectionID\":\"RB 49(15166)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":100,\"connectionID\":\"ICE 1573\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":101,\"connectionID\":\"RB 49(15168)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":102,\"connectionID\":\"RB 16(24564)\",\"vehicle\":\"Train\",\"origin\":\"HG-A5\"},{\"arrivalTick\":104,\"connectionID\":\"RE 98(24408)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":104,\"connectionID\":\"RE 98(24438)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":104,\"connectionID\":\"RE 99(24908)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":104,\"connectionID\":\"RE 99(24958)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":116,\"connectionID\":\"RB 41(15005)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":116,\"connectionID\":\"RB 41(15005)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":116,\"connectionID\":\"RB 15149\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":116,\"connectionID\":\"RB 40(15105)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":118,\"connectionID\":\"RB 41(15006)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":118,\"connectionID\":\"RB 40(15106)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":125,\"connectionID\":\"RB 16(24510)\",\"vehicle\":\"Train\",\"origin\":\"HG-A5\"},{\"arrivalTick\":127,\"connectionID\":\"RB 49(15170)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":129,\"connectionID\":\"RB 47(24611)\",\"vehicle\":\"Train\",\"origin\":\"WÖ-A45\"},{\"arrivalTick\":132,\"connectionID\":\"RE 98(24403)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":132,\"connectionID\":\"RE 99(24905)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":132,\"connectionID\":\"RE 98(24405)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":132,\"connectionID\":\"RE 98(24425)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":135,\"connectionID\":\"ICE 1672\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":135,\"connectionID\":\"ICE 1672\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":155,\"connectionID\":\"RB 16(24512)\",\"vehicle\":\"Train\",\"origin\":\"HG-A5\"},{\"arrivalTick\":157,\"connectionID\":\"RB 49(15076)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":157,\"connectionID\":\"RB 48(24261)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":162,\"connectionID\":\"RB 41(15007)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":162,\"connectionID\":\"RB 41(15007)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":162,\"connectionID\":\"RB 16(24566)\",\"vehicle\":\"Train\",\"origin\":\"HG-A5\"},{\"arrivalTick\":162,\"connectionID\":\"RB 40(15107)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":164,\"connectionID\":\"RE 30(4154)\",\"vehicle\":\"Train\",\"origin\":\"Frankfurt\"},{\"arrivalTick\":184,\"connectionID\":\"RB 49(15077)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":185,\"connectionID\":\"RB 16(24514)\",\"vehicle\":\"Train\",\"origin\":\"HG-A5\"},{\"arrivalTick\":186,\"connectionID\":\"RB 47(24665)\",\"vehicle\":\"Train\",\"origin\":\"WÖ-A45\"},{\"arrivalTick\":189,\"connectionID\":\"RB 47(24613)\",\"vehicle\":\"Train\",\"origin\":\"WÖ-A45\"},{\"arrivalTick\":191,\"connectionID\":\"RE 30(4155)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":191,\"connectionID\":\"S6\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":194,\"connectionID\":\"RB 41(15008)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":194,\"connectionID\":\"RB 40(15108)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":217,\"connectionID\":\"RB 49(15172)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":217,\"connectionID\":\"RB 48(24263)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":217,\"connectionID\":\"RB 48(61543)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":220,\"connectionID\":\"ICE 1575\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":221,\"connectionID\":\"RB 49(15174)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":221,\"connectionID\":\"S6\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":222,\"connectionID\":\"RB 16(24568)\",\"vehicle\":\"Train\",\"origin\":\"HG-A5\"},{\"arrivalTick\":224,\"connectionID\":\"RE 98(24410)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":224,\"connectionID\":\"RE 99(24910)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":236,\"connectionID\":\"RB 41(15009)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":236,\"connectionID\":\"RB 41(15009)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":236,\"connectionID\":\"RB 40(15109)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":238,\"connectionID\":\"RB 41(15010)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":238,\"connectionID\":\"RB 40(15110)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":245,\"connectionID\":\"RB 16(24516)\",\"vehicle\":\"Train\",\"origin\":\"HG-A5\"},{\"arrivalTick\":249,\"connectionID\":\"RB 47(24615)\",\"vehicle\":\"Train\",\"origin\":\"WÖ-A45\"},{\"arrivalTick\":251,\"connectionID\":\"S6\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":252,\"connectionID\":\"RE 99(24907)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":252,\"connectionID\":\"RE 98(24407)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":255,\"connectionID\":\"IC 2370\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":255,\"connectionID\":\"IC 2370\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":277,\"connectionID\":\"RB 49(15078)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":277,\"connectionID\":\"RB 48(24265)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":281,\"connectionID\":\"S6\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":282,\"connectionID\":\"RB 41(15011)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":282,\"connectionID\":\"RB 16(24570)\",\"vehicle\":\"Train\",\"origin\":\"HG-A5\"},{\"arrivalTick\":282,\"connectionID\":\"RB 40(15111)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":284,\"connectionID\":\"RE 30(4156)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":304,\"connectionID\":\"RB 49(15079)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":305,\"connectionID\":\"RB 16(24518)\",\"vehicle\":\"Train\",\"origin\":\"HG-A5\"},{\"arrivalTick\":306,\"connectionID\":\"RB 47(24667)\",\"vehicle\":\"Train\",\"origin\":\"WÖ-A45\"},{\"arrivalTick\":309,\"connectionID\":\"RB 47(24617)\",\"vehicle\":\"Train\",\"origin\":\"WÖ-A45\"},{\"arrivalTick\":311,\"connectionID\":\"RE 30(4157)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":311,\"connectionID\":\"S6\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":314,\"connectionID\":\"RB 41(15012)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":314,\"connectionID\":\"RB 40(15112)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":334,\"connectionID\":\"RB 49(15081)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":337,\"connectionID\":\"RB 49(15176)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":337,\"connectionID\":\"RB 48(24267)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":337,\"connectionID\":\"RB 48(61545)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":341,\"connectionID\":\"ICE 1577\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":341,\"connectionID\":\"RB 49(15178)\",\"vehicle\":\"Train\",\"origin\":\"NI-HU\"},{\"arrivalTick\":341,\"connectionID\":\"S6\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":342,\"connectionID\":\"RB 16(24572)\",\"vehicle\":\"Train\",\"origin\":\"HG-A5\"},{\"arrivalTick\":344,\"connectionID\":\"RE 98(24412)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":344,\"connectionID\":\"RE 99(24912)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":356,\"connectionID\":\"RB 41(15013)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":356,\"connectionID\":\"RB 41(15013)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":356,\"connectionID\":\"RB 40(15113)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"},{\"arrivalTick\":358,\"connectionID\":\"RB 41(15014)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":358,\"connectionID\":\"RB 40(15114)\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":365,\"connectionID\":\"RB 16(24520)\",\"vehicle\":\"Train\",\"origin\":\"HG-A5\"},{\"arrivalTick\":369,\"connectionID\":\"RB 47(24619)\",\"vehicle\":\"Train\",\"origin\":\"WÖ-A45\"},{\"arrivalTick\":371,\"connectionID\":\"S6\",\"vehicle\":\"Train\",\"origin\":\"KA-FFM\"},{\"arrivalTick\":372,\"connectionID\":\"RE 99(24909)\",\"vehicle\":\"Train\",\"origin\":\"BB-GI\"}]", List.class);

            for (Object o : list) {
                TimeTableBean timeTableBean = new TimeTableBean();
                Map<String, Object> entryMap = (Map)o;

                for (String key : entryMap.keySet()) {

                    if(key.equals("arrivalTick")){
                        timeTableBean.setArrivalTick((Integer) entryMap.get(key));
                    }else if(key.equals("connectionID")){
                        timeTableBean.setConnectionId((String) entryMap.get(key));
                    }else if(key.equals("vehicle")){
                        timeTableBean.setVehicle((String) entryMap.get(key));
                    }else if(key.equals("origin")){
                        timeTableBean.setOrigin((String) entryMap.get(key));
                    }

                }
                if(!publicTransportTimeTable.containsKey(timeTableBean.getOrigin())){
                    publicTransportTimeTable.put(timeTableBean.getOrigin(), new ArrayList<TimeTableBean>());
                }

                publicTransportTimeTable.get(timeTableBean.getOrigin()).add(timeTableBean);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
        return publicTransportTimeTable;
    }

    public static Map<String, ArrayList<TimeTableBean>> getPublicTransportTimeTable() {
        if(publicTransportTimeTable.size() == 0) publicTransportTimeTable = parsePTTimeTable();
        return publicTransportTimeTable;
    }



}


